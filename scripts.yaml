bedtime_lights:
  alias: Bedtime Lights and Security
  sequence:
  - service: input_boolean.turn_off
    target:
      entity_id:
      - input_boolean.perimeter_front_open_ack
      - input_boolean.perimeter_front_open_ack
      - input_boolean.garage_open_ack
  - service: lock.lock
    target:
      entity_id: lock.front_door_lock
  - type: turn_off
    device_id: 17ee280aec38bda355534848e7f0d377
    entity_id: light.wled_fam_master
    domain: light
  - type: turn_off
    device_id: 096b8164b47a5fa128143e0d014f392e
    entity_id: light.wled_kitchen_master
    domain: light
  - type: turn_on
    device_id: 2c9b8e6d9142854d19aa37d4b75b14fa
    entity_id: light.kitchen_light
    domain: light
    brightness_pct: 25
  - type: turn_on
    device_id: b83943abdd7e16bae8848e72a44de128
    entity_id: light.stairs_light
    domain: light
    brightness_pct: 50
  - delay:
      hours: 0
      minutes: 0
      seconds: 31
      milliseconds: 0
  - choose:
    - conditions:
      - condition: state
        entity_id: group.any_perimeter_open
        state: 'on'
      sequence:
      - service: script.announce_everywhere
        data:
          message: 'Attention. The following doors or windows are still open:  {%
            if is_state(''binary_sensor.front_entry_sensor'',''on'') %}Front Entry,
            {% endif %} {% if is_state(''binary_sensor.garage_door_sensor'',''on'')
            %}Garage Door, {% endif %} {% if is_state(''binary_sensor.garage_entry_sensor'',''on'')
            %}Garage Entry, {% endif %} {% if is_state(''binary_sensor.sliding_door_sensor'',''on'')
            %}Sliding Door, {% endif %} {% if is_state(''binary_sensor.office_window_sensor'',''on'')
            %}Office Window, {% endif %} . Please close.'
    default:
    - service: script.announce_everywhere
      data:
        message: Perimeter is secure.
  - type: turn_on
    device_id: 2876947463a17fcde130a8fac4ea5bfa
    entity_id: light.mbr_light
    domain: light
    brightness_pct: 30
  - wait_for_trigger:
    - platform: state
      entity_id: group.open_area_motion
      to: 'off'
      for: '90'
    timeout: 00:08:00
  - scene: scene.basement_light_off
  - scene: scene.1st_floor_light_off
  - type: turn_off
    device_id: b83943abdd7e16bae8848e72a44de128
    entity_id: light.stairs_light
    domain: light
  mode: single
  icon: mdi:lightbulb-outline
lights_to_level_kitchen_breakfast:
  alias: 'Lights-To-Level: Kitchen-Breakfast'
  sequence:
  - choose:
    - conditions:
      - condition: template
        value_template: "{% if ( to_brightness > 0  ) %}\ntrue\n{% else %}\nfalse\
          \ \n{% endif %}\n"
      sequence:
      - service: light.turn_on
        target:
          entity_id:
          - light.breakfast_rm_light
          - light.kitchen_light
        data_template:
          brightness_pct: '{{ to_brightness }}'
    default:
    - service: light.turn_off
      target:
        entity_id:
        - light.breakfast_rm_light
        - light.kitchen_light
  mode: single
  icon: mdi:lightbulb-outline
  fields:
    to_brightness:
      description: Brightness to set lights to
      example: '50'
